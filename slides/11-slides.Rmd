---
title: "Lab 11 (?): CS631"
subtitle: "One Dataset, Visualized 11 Ways"
author: "Alison Hill, Steven Bedrick, Jackie Wirz"
output:
  xaringan::moon_reader:
    css: ["default", "css/ohsu.css", "css/ohsu-fonts.css"]
    lib_dir: libs
    nature:
      highlightStyle: atelier-lakeside-light
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE, 
  comment = NA, dpi = 300,
  fig.align = "center", out.width = "70%", cache = FALSE)
library(tidyverse)
library(here)
library(knitr)
```


class: center, middle, inverse

# Inspired by:

## Flowing Data:

https://flowingdata.com/2017/01/24/one-dataset-visualized-25-ways/


---
# Packages first

I'll use all of the following:

```{r}
library(tidyverse)
library(wesanderson) # colors
library(viridis) # colors!
library(beyonce) # colors!!
library(extrafont) # mess with fonts
```

---
# Data second

```{r}
ratings <- read_csv(here::here("data", "episodes.csv"),
                           na = c("", "NA", "N/A"),
                         col_types = cols(
                           viewers_7day = col_number(),
                           series = col_factor(levels = NULL)
                         )) 
```

---
# Glimpse

```{r echo = FALSE}
glimpse(ratings)
```


---
class: center, middle, inverse

# ðŸŽ‚

## Recipe 1: Continuous Bar Chart

---
## Recipe 1: Continuous Bar Chart

```{r echo = FALSE, out.width = '70%'}
# some small wrangling
ratings_bonanza1 <- ratings %>% 
  mutate(ep_id = row_number(),
         series = as.factor(series)) %>% 
  select(ep_id, viewers_7day, series)

# my colors from beyonce
mybey <- beyonce_palette(66)[c(11,10,7,6,5,4,3,1)]

# make the plot
ggplot(ratings_bonanza1, aes(x = ep_id, y = viewers_7day, 
                             fill = series)) +
  geom_col(alpha = .9) +
  theme_minimal() +
  ggtitle("Series 8 was a Big Setback in Viewers",
          subtitle= "7-Day Viewers across All Series/Episodes") +
  theme(legend.position = "bottom",
        text = element_text(family = "Lato")) + 
  scale_fill_manual(values = mybey) +
  guides(fill = guide_legend(nrow = 1))
```

---
## Recipe 1: Code for Bar Chart

```{r eval = FALSE}
# some small wrangling
ratings_bonanza1 <- ratings %>% 
  mutate(ep_id = row_number(),
         series = as.factor(series)) %>% 
  select(ep_id, viewers_7day, series)

# my colors from beyonce
mybey <- beyonce_palette(66)[c(11,10,7,6,5,4,3,1)]

# make the plot
ggplot(ratings_bonanza1, aes(x = ep_id, y = viewers_7day, 
                             fill = series)) +
  geom_col(alpha = .9) +
  theme_minimal() +
  ggtitle("Series 8 was a Big Setback in Viewers",
          subtitle= "7-Day Viewers across All Series/Episodes") +
  theme(legend.position = "bottom",
        text = element_text(family = "Lato")) + 
  scale_fill_manual(values = mybey) +
  guides(fill = guide_legend(nrow = 1))
```


---
class: center, middle, inverse

# ðŸŽ‚

## Recipe 2: Grouped Line Plot by Series

---
## Recipe 2: Grouped Line Plot by Series 

```{r echo = FALSE, out.width='70%'}
mybey <- beyonce_palette(66)[c(11,10,7,6,5,4,3,1)]

ggplot(ratings, aes(x = as.factor(episode), y = viewers_7day,
                    color = fct_reorder2(series, episode, viewers_7day), 
                    group = series)) +
  geom_line() +
  theme_minimal() +
  scale_color_manual(values = mybey) +
  labs(color = "Series", xlab = "Episode") +
  theme(text = element_text(family = "Lato")) 
```

---
## Recipe 2: Code for Series Grouped Line Plot

```{r eval = FALSE}
mybey <- beyonce_palette(66)[c(11,10,7,6,5,4,3,1)]

ggplot(ratings, aes(x = as.factor(episode), y = viewers_7day,
                    color = fct_reorder2(series, episode, viewers_7day), 
                    group = series)) +
  geom_line() +
  theme_minimal() +
  scale_color_manual(values = mybey) +
  labs(color = "Series", xlab = "Episode") +
  theme(text = element_text(family = "Lato")) 
```

---
class: center, middle, inverse

# ðŸŽ‚

## Recipe 3: Grouped Line Plot by Episode

---
## Recipe 3: Grouped Line Plot by Episode

```{r echo = FALSE, out.width='60%'}
# some wrangling here
ratings_bonanza3 <- ratings %>% 
  select(series, episode, viewers_7day) %>% 
  group_by(series) %>% 
  filter(episode == 1 | episode == max(episode)) %>% 
  mutate(episode = recode(episode, `1` = "first", .default = "last")) %>% 
  ungroup()

# code for plot
ggplot(ratings_bonanza3, aes(x = series, y = viewers_7day,
                             color = fct_reorder2(episode, series, viewers_7day), 
                             group = episode)) +
  geom_point() + 
  geom_line() +
  scale_color_manual(values = rev(beyonce_palette(18))) +
  theme_minimal() +
  ggtitle("Great British Bake Off Finales Get More Viewers than Premieres") +
  theme(text = element_text(family = "Lato")) +
  labs(color = "Episode")
```

---
## Recipe 3: Code for Grouped Episode Line Plot 

```{r eval = FALSE}
# some wrangling here
ratings_bonanza3 <- ratings %>% 
  select(series, episode, viewers_7day) %>% 
  group_by(series) %>% 
  filter(episode == 1 | episode == max(episode)) %>% 
  mutate(episode = recode(episode, `1` = "first", .default = "last"))  

# code for plot
ggplot(ratings_bonanza3, aes(x = series, y = viewers_7day, 
                             color = fct_reorder2(episode, series, viewers_7day),
                             group = episode)) +
  geom_point() + 
  geom_line() +
  scale_color_manual(values = rev(beyonce_palette(18))) +
  theme_minimal() +
  ggtitle("Great British Bake Off Finales Get More Viewers than Premieres") +
  theme(text = element_text(family = "Lato")) +
  labs(color = "Episode")
```

---
class: center, middle, inverse

# ðŸŽ‚

## Recipe 4: Dumbbell Plot

---
## Recipe 4: Dumbbell Plot


```{r echo = FALSE, out.width='60%'}
ggplot(ratings_bonanza3, aes(x = viewers_7day, y = fct_rev(series), 
                             color = episode, group = series)) +
  geom_line(size = .75) +
  geom_point(size = 2.5) +
  scale_color_manual(values = rev(beyonce_palette(18))) +
  theme_minimal() +
  labs(y = "Series", x = "Viewers (millions)") +
  ggtitle("Great British Bake Off Finales Get More Viewers than Premieres") +
  theme(text = element_text(family = "Lato")) 
```

---
## Recipe 4: Code for Dumbbell Plot


```{r eval = FALSE}
ggplot(ratings_bonanza3, aes(x = viewers_7day, y = fct_rev(series), 
                             color = episode, group = series)) +
  geom_line(size = .75) +
  geom_point(size = 2.5) +
  scale_color_manual(values = rev(beyonce_palette(18))) +
  theme_minimal() +
  labs(y = "Series", x = "Viewers (millions)") +
  ggtitle("Great British Bake Off Finales Get More Viewers than Premieres") +
  theme(text = element_text(family = "Lato")) 
```

---
class: center, middle, inverse

# ðŸŽ‚

## Recipe 5: Slope Graph

---
## Recipe 5: Slope Graph 


```{r echo = FALSE, out.width='65%'}
mybey <- beyonce_palette(66)[c(11,10,7,6,5,4,3,1)]

ggplot(ratings_bonanza3, aes(x = episode, y = viewers_7day,
                             color = fct_reorder2(series, episode, viewers_7day),
                             group = series)) +
  geom_point() +
  geom_line() +
  theme_minimal() +
  scale_color_manual(values = mybey) +
  labs(color = "Series") +
  theme(text = element_text(family = "Lato")) 
```

---
## Recipe 5: Code for Slope Graph

```{r eval = FALSE}
mybey <- beyonce_palette(66)[c(11,10,7,6,5,4,3,1)]

ggplot(ratings_bonanza3, aes(x = episode, y = viewers_7day,
                             color = fct_reorder2(series, episode, viewers_7day),
                             group = series)) +
  geom_point() +
  geom_line() +
  theme_minimal() +
  scale_color_manual(values = mybey) +
  labs(color = "Series") +
  theme(text = element_text(family = "Lato")) 
```

---
class: center, middle, inverse

# ðŸŽ‚

## Recipe 6: Bar Chart

---
## Recipe 6: Bar Chart

```{r echo = FALSE, out.width='70%'}
# some more serious wrangling here
ratings_bonanza6 <- ratings_bonanza3 %>% 
  spread(episode, viewers_7day) %>% 
  mutate(finale_bump = last - first)

# plot
ggplot(ratings_bonanza6, aes(x = fct_rev(series), 
                             y = finale_bump)) +
  geom_col(fill = beyonce_palette(49)[1], alpha = .5) +
  coord_flip() +
  labs(x = "Series", y = "Difference in Viewers for Finale from Premiere (millions)") +
  theme_minimal() +
  ggtitle("Finale 'Bumps' were Smallest for Series 1 and 8",
          subtitle= "Finale 7-day Viewers Relative to Premiere") +
  theme(text = element_text(family = "Lato")) 
```

---
## Recipe 6: Code for "Bumps" Bar Chart

```{r eval = FALSE}
# some more serious wrangling here
ratings_bonanza6 <- ratings_bonanza3 %>% 
  spread(episode, viewers_7day) %>% 
  mutate(finale_bump = last - first) 

# plot
ggplot(ratings_bonanza6, aes(x = fct_rev(series), 
                             y = finale_bump)) +
  geom_col(fill = beyonce_palette(49)[1], alpha = .5) +
  coord_flip() +
  labs(x = "Series", y = "Difference in Viewers for Finale from Premiere (millions)") +
  theme_minimal() +
  ggtitle("Finale 'Bumps' were Smallest for Series 1 and 8",
          subtitle= "Finale 7-day Viewers Relative to Premiere") +
  theme(text = element_text(family = "Lato")) 
```

---
class: center, middle, inverse

# ðŸŽ‚

## Recipe 7: Bar Chart, Take 2!

---
## Recipe 7: Bar Chart

```{r echo = FALSE, out.width='70%'}
# some more serious wrangling here
ratings_bonanza7 <- ratings_bonanza6 %>% 
  mutate(finale_bump_median = finale_bump - median(finale_bump),
         bump_sign = if_else(finale_bump_median > 0, 1, 0))

# plot
ggplot(ratings_bonanza7, aes(x = fct_rev(series), 
                             y = finale_bump_median,
                             fill = as.factor(bump_sign))) +
  geom_col(alpha = .5) +
  coord_flip() +
  labs(x = "Series", y = "Difference in Millions of Viewers Compared to Median Finale Bump") +
  scale_fill_manual(values = rev(beyonce_palette(121)), guide = FALSE) +
  theme_minimal() +
  ggtitle("Compared to the Median, Series 1 and 8 had the Most Disappointing Finales",
          subtitle= "Each Series' Finale 'Bump' Calculated as Finale Minus Premiere 7-day Viewers") +
  theme(text = element_text(family = "Lato")) 
```

---
## Recipe 7: Code for Bar Chart

```{r eval = FALSE}
# some more serious wrangling here
ratings_bonanza7 <- ratings_bonanza6 %>% 
  mutate(finale_bump_median = finale_bump - median(finale_bump),
         bump_sign = if_else(finale_bump_median > 0, 1, 0))

# plot
ggplot(ratings_bonanza7, aes(x = fct_rev(series), 
                             y = finale_bump_median,
                             fill = as.factor(bump_sign))) +
  geom_col(alpha = .5) +
  coord_flip() +
  labs(x = "Series", y = "Difference in Millions of Viewers Compared to Median Finale Bump") +
  scale_fill_manual(values = rev(beyonce_palette(121)), guide = FALSE) +
  theme_minimal() +
  ggtitle("Compared to the Median, Series 1 and 8 had the Most Disappointing Finales",
          subtitle= "Each Series' Finale 'Bump' Calculated as Finale Minus Premiere 7-day Viewers") +
  theme(text = element_text(family = "Lato")) 
```

---
class: center, middle, inverse

# ðŸŽ‚

## Recipe 8: Scatterplot

---
## Recipe 8: Scatterplot

```{r echo = FALSE}
ggplot(ratings_bonanza7, aes(x = first, y = last)) +
  geom_point() +
  geom_smooth(se = FALSE, color = '#EBBFDD') +
  geom_abline(slope = 1, intercept = 0, color = "gray", alpha = .5) +
  theme_minimal() +
  geom_text(aes(label = series), hjust = -1, family = "Lato") +
  theme(text = element_text(family = "Lato")) +
  labs(x = "Premiere Episode 7-day Viewers (millions)",
       y = "Finale Episode 7-day Viewers (millions)")
```

---
## Recipe 8: Code for Scatterplot

```{r eval = FALSE}
ggplot(ratings_bonanza7, aes(x = first, y = last)) +
  geom_point() +
  geom_smooth(se = FALSE, color = '#EBBFDD') +
  geom_abline(slope = 1, intercept = 0, color = "gray", alpha = .5) +
  theme_minimal() +
  geom_text(aes(label = series), hjust = -1, family = "Lato") +
  theme(text = element_text(family = "Lato")) +
  labs(x = "Premiere Episode 7-day Viewers (millions)",
       y = "Finale Episode 7-day Viewers (millions)")
```

---
class: center, middle, inverse

# ðŸŽ‚

## Recipe 9: Pop-Out Scatterplot

---
## Recipe 9: Pop-Out Scatterplot

```{r echo = FALSE}
ggplot(ratings_bonanza7, aes(x = first, y = last)) +
  geom_abline(slope = 1, intercept = 0, color = "gray", alpha = .5) +
  geom_smooth(se = FALSE, color = "#11B2E8") +
  geom_point(data = filter(ratings_bonanza7, series %in% c(1:7))) +
  geom_point(data = filter(ratings_bonanza7, series == 8), colour = "#CF2154") +
  geom_text(data = filter(ratings_bonanza7, series %in% c(1:7)),
            aes(label = series), hjust = -1, family = "Lato") +
  geom_text(data = filter(ratings_bonanza7, series == 8),
            aes(label = series), hjust = -1, family = "Lato", colour = "#CF2154") +
  theme_minimal() +
  theme(text = element_text(family = "Lato")) +
  labs(x = "Premiere Episode 7-day Viewers (millions)",
       y = "Finale Episode 7-day Viewers (millions)")
```

---
## Recipe 9: Code for Pop-Out Scatterplot

```{r eval = FALSE}
ggplot(ratings_bonanza7, aes(x = first, y = last)) +
  geom_abline(slope = 1, intercept = 0, color = "gray", alpha = .5) +
  geom_smooth(se = FALSE, color = "#11B2E8") +
  geom_point(data = filter(ratings_bonanza7, series %in% c(1:7))) +
  geom_point(data = filter(ratings_bonanza7, series == 8), 
             colour = "#CF2154") +
  geom_text(data = filter(ratings_bonanza7, series %in% c(1:7)),
            aes(label = series), hjust = -1, family = "Lato") +
  geom_text(data = filter(ratings_bonanza7, series == 8),
            aes(label = series), hjust = -1, family = "Lato", 
            colour = "#CF2154") +
  theme_minimal() +
  theme(text = element_text(family = "Lato")) +
  labs(x = "Premiere Episode 7-day Viewers (millions)",
       y = "Finale Episode 7-day Viewers (millions)")
```

---
class: center, middle, inverse

# ðŸŽ‚

## Recipe 10: Redo Recipe 2 

## Pop-Out Series Grouped Line Plot

---
## Recipe 10: Redo Recipe 2

```{r echo = FALSE, out.width='60%'}
ggplot(ratings, aes(x = episode, y = viewers_7day,
                    group = series)) +
  geom_line(data = filter(ratings, !series == 8), alpha = .25) +
  geom_line(data = filter(ratings, series == 8), color = "#CF2154") +
  theme_minimal() +
  labs(color = "Series") +
  theme(text = element_text(family = "Lato")) +
  ggtitle("Series 8 was a Tough One")
```

---
## Recipe 10: Code for Redo Recipe 2

```{r eval = FALSE}
ggplot(ratings, aes(x = episode, y = viewers_7day,
                    group = series)) +
  geom_line(data = filter(ratings, !series == 8), alpha = .25) +
  geom_line(data = filter(ratings, series == 8), color = "#CF2154") +
  theme_minimal() +
  labs(color = "Series") +
  theme(text = element_text(family = "Lato")) +
  ggtitle("Series 8 was a Tough One")
```

---
class: center, middle, inverse

# ðŸŽ‚

## Recipe 11: Redo Recipe 5 

## Pop-Out Slope Graph

---
## Recipe 11: Redo Recipe 5 


```{r echo = FALSE, out.width='65%'}
ggplot(ratings_bonanza3, aes(x = episode, y = viewers_7day,
                             group = series)) +
  geom_point(data = filter(ratings_bonanza3, !series == 8), alpha = .25) +
  geom_point(data = filter(ratings_bonanza3, series == 8), 
             color = "#CF2154") +
  geom_line(data = filter(ratings_bonanza3, !series == 8), alpha = .25) +
  geom_line(data = filter(ratings_bonanza3, series == 8), 
            color = "#CF2154") +
  theme_minimal() +
  theme(text = element_text(family = "Lato")) +
  ggtitle("Series 8 was a Tough One")
```

---
## Recipe 11: Redo Recipe 5 


```{r eval = FALSE}
ggplot(ratings_bonanza3, aes(x = episode, y = viewers_7day,
                             group = series)) +
  geom_point(data = filter(ratings_bonanza3, !series == 8), alpha = .25) +
  geom_point(data = filter(ratings_bonanza3, series == 8), 
             color = "#CF2154") +
  geom_line(data = filter(ratings_bonanza3, !series == 8), alpha = .25) +
  geom_line(data = filter(ratings_bonanza3, series == 8), 
            color = "#CF2154") +
  theme_minimal() +
  theme(text = element_text(family = "Lato")) +
  ggtitle("Series 8 was a Tough One")
```