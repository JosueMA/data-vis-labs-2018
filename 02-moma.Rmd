---
title: "Lab 02: MOMA Museum Tour"
subtitle: "CS631"
author: "Alison Hill"
output:
  html_document:
    highlight: pygments
    theme: flatly
    toc: TRUE
    toc_float: TRUE
    toc_depth: 2
    number_sections: TRUE
    code_folding: hide
---
```{r setup, include = FALSE, cache = FALSE}
knitr::opts_chunk$set(error = TRUE, comment = NA, warning = FALSE, errors = FALSE, message = FALSE, tidy = FALSE, cache = FALSE)
```

# Goals for Lab 02

# Inspiration + data

https://fivethirtyeight.com/features/a-nerds-guide-to-the-2229-paintings-at-moma/

https://github.com/MuseumofModernArt/collection

https://medium.com/@foe/here-s-a-roundup-of-how-people-have-used-our-data-so-far-80862e4ce220

# Packages needed

```{r}
library(here) # to set file path if working from local file
library(tidyverse) # readr, tidyr, ggplot2, dplyr
```


# Read in the data

Note! This is not the original data- I did a lot of cleaning and decision-making in the pre-processing. The below contains only paintings and drawings in the MOMA collection.

Use this code chunk to read in the data available at [http://bit.ly/cs631-moma](http://bit.ly/cs631-moma):

```{r eval = FALSE}
library(readr)
moma <- read_csv("http://bit.ly/cs631-moma")
```

I called my cleaned data `artworks-cleaned.csv`, and stored it in a folder called `data`. You can use this code if you want to read in the local CSV file.

```{r}
library(here)
library(readr)
library(dplyr)
moma <- read_csv(here::here("data", "artworks-cleaned.csv"))
```




# Challenge 1: Know your data

## How many paintings?

- How many rows/observations are in `moma`?
- How many variables are in `moma`?

These questions can be answered using the `dplyr` function `glimpse`.

```{r}
library(dplyr)
moma
glimpse(moma)
```

There are `r nrow(moma)` paintings in `moma`.

## What is the earliest painting acquired?


- What is the earliest painting ever acquired by MOMA? 
- Which year?
- Which artist?
- What title?

These questions can be answered by combining two `dplyr` functions: `select` and `arrange`.

```{r}
moma %>% 
  select(artist, title, year_acquired) %>% 
  arrange(year_acquired)
```

## What is the earliest painting created (oldest)?


- What is the earliest painting ever created in the MOMA collection historically (oldest painting)? 
- Which year?
- Which artist?
- What title?

These questions can be answered by combining two `dplyr` functions: `select` and `arrange`.

```{r}
moma %>% 
  select(artist, title, year_created) %>% 
  arrange(year_created)
```

```{r include = FALSE}
oldest <- moma %>% 
  select(artist, title, year_created) %>% 
  arrange(year_created) %>% 
  slice(1)
```

To do inline comments, I could say that the oldest painting is `r oldest %>% pull(title)`, painted by `r oldest %>% pull(artist)` in `r oldest %>% pull(year_created)`.

## How many artists?

- How many distinct artists are there?

Try `dplyr::distinct`.

```{r}
moma %>% 
  distinct(artist)
```

## How many paintings per artist?

- Which artist has the most paintings ever owned by `moma`? 
- How many were there by that artist?

Try `dplyr::count`. Use `?count` to figure out how to sort the output.

```{r}
moma %>% 
  count(artist, sort = TRUE)
```



## In what year were the most paintings acquired?

Try `dplyr::count`. Use `?count` to figure out how to sort the output.

```{r}
moma %>% 
  count(year_acquired, sort = TRUE)
```

## In what year were the most paintings created?

Try `dplyr::count`. Use `?count` to figure out how to sort the output.

```{r}
moma %>% 
  count(year_created, sort = TRUE)
```

## What about first painting by a solo female artist?

Try combining three `dplyr` functions: `filter`, `select`, and `arrange`. Try `year_acquired` and `year_created`!

```{r}
moma %>% 
  filter(num_artists == 1 & n_female_artists == 1) %>% 
  select(title, artist, year_acquired, year_created) %>% 
  arrange(year_acquired)
```

```{r}
moma %>% 
  filter(num_artists == 1 & n_female_artists == 1) %>% 
  select(title, artist, year_acquired, year_created) %>% 
  arrange(year_created)
```

```{r eval = FALSE}
# or, because artist_gender is missing when num_artists > 1
moma %>% 
  filter(artist_gender == "Female") %>% 
  select(title, artist, year_acquired, year_created) %>% 
  arrange(year_acquired)
```

# Challenge 2: On paper first!

# Challenge 3: Plot your data

From [fivethirtyeight](https://fivethirtyeight.com/features/a-nerds-guide-to-the-2229-paintings-at-moma/). Let's recreate this plot (mostly)!

![](https://espnfivethirtyeight.files.wordpress.com/2015/08/roeder-feature-moma-1.png?w=1150&quality=90&strip=info)

## Plot year painted vs year acquired

Things to consider:

- You'll want to play around with setting an `alpha` value here- keep in mind that `0` is totally transparent and `1` is opaque. 
- Try using `geom_abline()` to add the line in red.
- Go back to [Lab 01](https://apreshill.github.io/data-vis-labs-2018/01-eda_hot_dogs.html) to review how to do the following:
    - Change the x- and y-axis labels and the plot title to match the plot above

```{r}
ggplot(moma, aes(year_created, year_acquired)) +
  geom_point(alpha = .1) +
  geom_abline(intercept = c(0,0), colour = "red") +
  labs(x = "Year Created", y = "Year Acquired") +
  ggtitle("MOMA Keeps Its Collection Current") 
```

## Facet by artist gender

Can you make the same plot above, but facet by artist gender? For this to make sense, you probably want to do some filtering to select only those paintings where there was one "solo" artist. 

```{r}
moma_solo <- moma %>% 
  filter(num_artists == 1)
ggplot(moma_solo, aes(year_created, year_acquired)) +
  geom_point(alpha = .1) +
  geom_abline(intercept = c(0,0), colour = "red") +
  labs(x = "Year Created", y = "Year Acquired") +
  ggtitle("MOMA Keeps Its Collection Current") +
  facet_wrap(~artist_gender)
```


# Challenge 4: Plot painting dimensions

Let's (somewhat) try to recreate this scatterplot from [fivethirtyeight](https://fivethirtyeight.com/features/a-nerds-guide-to-the-2229-paintings-at-moma/). 

![](https://espnfivethirtyeight.files.wordpress.com/2015/08/roeder-feature-moma-3.png?w=1150&quality=90&strip=info)


To recreate, some things to consider:

- Try filtering all paintings with height less than 600 cm and width less than 760 cm. 
- If you want to add color as in the original, you'll need to create a new variable using `mutate`. 
- You'll probably also want to look into `case_when`.

```{r}
moma_dim <- moma %>% 
  filter(height_cm < 600, width_cm < 760) %>% 
  mutate(hw_ratio = height_cm / width_cm,
         hw_cat = case_when(
           hw_ratio > 1 ~ "taller than wide",
           hw_ratio < 1 ~ "wider than tall",
           hw_ratio == 1 ~ "perfect square"
         ))
library(ggthemes)
ggplot(moma_dim, aes(x = width_cm, y = height_cm, colour = hw_cat)) +
  geom_point(alpha = .5) +
  ggtitle("MOMA Paintings, Tall and Wide") +
  scale_colour_manual(name = "",
                      values = c("gray50", "#FF9900", "#B14CF0")) +
  theme_fivethirtyeight() +
  theme(axis.title = element_text()) +
  labs(x = "Width", y = "Height") 
```



